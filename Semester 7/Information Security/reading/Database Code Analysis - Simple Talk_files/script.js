(()=>{"use strict";const e={getUrlParameterByName:function(e){var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null!==t&&decodeURIComponent(t[1].replace(/\+/g," "))},onPage:function(e){var t=!1;"string"==typeof e&&(e=[e]);for(var n=0;n<e.length;n++)-1!==window.location.href.indexOf(e[n])&&(t=!0);return t}};var t="open",n="closed",o=function(e,t){for(var n=[],o=t.parentElement;null!==o;)o.classList.contains("dropdown")&&n.push(o),o=o.parentElement;for(var a=0;a<n.length;a++)if(e===n[a])return!0;return!1};var a=void 0,r=function(e,t){var n=window.jQuery(e).attr("href"),o=window.jQuery(n);if(o.is(".js-reveal")){var r=window.jQuery('.js-reveal-cta[href="'+n+'"]');o.slideDown({duration:250,complete:function(){o.addClass("js-reveal-open"),r.addClass("close"),r.each((function(){var e=window.jQuery(this);e.attr("data-reveal-cta-close-html")&&e.html(e.attr("data-reveal-cta-close-html"))})),"function"==typeof t&&t.call(a)}})}},c=function(e,t){var n=window.jQuery(e).attr("href"),o=window.jQuery(n);if(o.is(".js-reveal")){var r=window.jQuery('.js-reveal-cta[href="'+n+'"]');o.slideUp({duration:250,complete:function(){o.removeClass("js-reveal-open"),r.removeClass("close"),r.each((function(){var e=window.jQuery(this);e.attr("data-reveal-cta-open-html")&&e.html(e.attr("data-reveal-cta-open-html"))})),"function"==typeof t&&t.call(a)}})}};const s=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!1!==e){var a=document.createElement("script"),r=window.Honeycomb&&window.Honeycomb.path?window.Honeycomb.path:"";a.type="text/javascript",a.src=null!==e.match("://")?e:r+e;var i=!1;for(var c in a.onload=a.onreadystatechange=function(){i||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(i=!0,"function"==typeof t&&t.apply())},"function"==typeof o&&(a.onerror=o),n)a[c]=n[c];var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(a,s)}};var d=void 0,l=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=document.querySelectorAll(".js-lightbox, .js-lightbox--video, .js-lightbox--iframe, .js-lightbox--image, .js-lightbox--inline, .js-lightbox--ajax, .js-lightbox--swf, .js-lightbox--html");n.length&&(void 0===window.jQuery.fancybox?(void 0===t.url&&(t.url="lightbox/vendor/jquery.fancybox.min.js"),s(t.url,(function(){e()}))):(window.jQuery(".js-lightbox").fancybox(),window.jQuery(".js-lightbox--video, .js-lightbox--iframe").fancybox({type:"iframe"}),window.jQuery(".js-lightbox--image").fancybox({type:"image"}),window.jQuery(".js-lightbox--inline").fancybox({type:"inline"}),window.jQuery(".js-lightbox--ajax").fancybox({type:"ajax"}),window.jQuery(".js-lightbox--swf").fancybox({type:"swf"}),window.jQuery(".js-lightbox--html").fancybox({type:"html"})))};var u,w,f,m,p=!1,v="crossDomain",g=function(){window.GoogleAnalyticsObject="ga",window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments)},window.ga.l=1*new Date;var e=document.createElement("script");e.async=1,e.src="//www.google-analytics.com/analytics.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)},h=function(e,t){return!(!e||"UA-XXX"===e)&&void 0!==window.ga&&(window.ga("create",e,"auto"),t&&w&&(window.ga("create",t,{name:v,cookieName:"_crossDomainGa",allowLinker:!0}),window.ga("".concat(v,".require"),"linker"),window.ga("".concat(v,".linker:autoLink"),w)),f&&window.ga("require",f),void window.ga("set","anonymizeIp",!0))},y=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e?{page:e}:{};if(void 0===window.ga)return!1;window.ga("send","pageview",t),p&&window.ga("".concat(v,".send"),"pageview",t)},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(void 0===window.ga)return!1;window.ga("send","event",e,t,n,o)},j=function(){for(var e=document.querySelectorAll(".lightbox--video"),t=0;t<e.length;t++)e[t].addEventListener("click",(function(e){var t=e.target.href.replace(/http(s)*:\/\/www.youtube.com\/embed\/|\?.*/g,"");b("Video",window.location.pathname,t)}))},k=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=e.querySelectorAll("[data-ga-track]"),n=0;n<t.length;n++)t[n].addEventListener("click",(function(e){for(var t=e.target;!t.hasAttribute("data-ga-track");)t=t.parentElement;var n=t.getAttribute("data-ga-track-category")||null,o=t.getAttribute("data-ga-track-action")||null,a=t.getAttribute("data-ga-track-label")||null,r=t.getAttribute("data-ga-track-value")||null;b(n,o,a,r)}))};const _={init:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!u||"UA-XXX"===u)return window.console.warn("Honeycomb: Google Analytics account ID is not set, therefore the Google Analytics script will not be loaded."),!1;g(),h(u,m),!1!==e.trackPageView&&y(),k(),j()},setAccountId:function(e){u=e},setCrossDomainAccountId:function(e){p=!0,m=e},setSites:function(e){w=e},setOptimizeId:function(e){f=e},trackPageView:y,trackEvent:b,setCustomVariable:function(e,t,n){if(void 0===window.ga)return!1;var o={};o["dimension"+e]=n,window.ga("send","pageview",o)},accountId:u,setupTrackingAlias:k};function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}var S,Q=$(".page-id-20401 form"),E="",q=function(e){var t=e.find("input[type=checkbox]"),n={};for(i=0;i<t.length;i++)n["WP0iWal3XRl7637634pL0QAowg"===t[i].value?".NET newsletter":"Simple Talk"]=t[i].checked?"subscribe":"unsubscribe";return n},C=function(){Q.submit((function(){if(E){var e=q(Q);for(var t in e)"subscribe"===e[t]&&ga(E+".send","event","subscription change",e[t],t+" - /account/sign-up")}}))},A=function(){var e=document.querySelectorAll(".widget_related_posts a");if(e.length)for(var t=0;t<e.length;t++)e[t].addEventListener("click",(function(e){window.ga(window.ST.analytics.trackerId+".send","event","Related post link click",e.target.href,window.location.pathname)}))};const L={init:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(S=e),null===document.body.getAttribute("data-ga-no-track-pageview")&&S.analytics.trackPageView(),void 0!==("undefined"==typeof ga?"undefined":x(ga))&&(E=ga.getAll()[0].get("name")),C(),A()},getCheckboxStates:q,getTrackerId:function(){return E}};const I=function(){!function(){var t=e.getUrlParameterByName("s");if(t&&$(".gsc-search-box").length>0){var n=$("input.gsc-input"),o=$(".gsc-search-button");n.focus(),n.val(t),o.trigger("click")}}()};var T=function(e){var t=document.createElement("a");return t.href=e,t},H=T(window.location.href).pathname,N=localStorage.getItem(H)?parseInt(localStorage.getItem(H)):0,B=!1,D=function e(t){var n,o=document.body,a=document.documentElement,r=Math.max(o.scrollHeight,o.offsetHeight,a.clientHeight,a.scrollHeight,a.offsetHeight),i=(document.getElementsByTagName("body")[0],document.querySelector(".article__content")?document.querySelector(".article__content").innerHTML:""),c=(i=(i=(i=(i=(i=i.replace(/<!--[\s\S]*?-->/g,"")).replace(/<(script|noscript|style|form|header|footer|nav)[\s\S]*?\>.*?<\/(script|noscript|style|form|header|footer|nav)\>/g,"")).replace(/<.*?\>/g,"")).replace(/\&nbsp\;/g," ")).replace(/\s+/g," ")).split(" ").length/330,s=T(window.location.href).pathname+"?read=true",d=window,l=document,u=l.documentElement,w=l.getElementsByTagName("body")[0],f=(d.innerWidth||u.clientWidth||w.clientWidth,d.innerHeight||u.clientHeight||w.clientHeight);window.onblur=function(){n&&(clearInterval(n),n=null)},window.onfocus=function(){e(t)},window.onbeforeunload=function(){try{localStorage.setItem(H,t)}catch(e){console.log("Storage failed: "+e)}},B||(n=setInterval((function(){t=parseInt(t)+parseInt(2e3);var e=document.body.scrollTop||document.documentElement.scrollTop||window.scrollY,o=document.querySelector("[id^=discussion],[id=shareBottom],#comments,#commentarea,[name=comments],[class^=comment_form],[class^=entry-comments],.FBComments,fb\\:comments,div[id^=coment],#forum,[id^=disqus_thread],#related-content,#RelatedPostsContainer,.post-latest,#notas-rel,div[class=post-footer],div[class=morearticles],footer"),a=parseInt(r);if(o&&(a=parseInt(o.offsetTop)-parseInt(f)),t/6e4>=.75*parseInt(c)&&e>=.85*a){"ga"in window?(ga("send","pageview",s),ga("send","event","read","read",s)):"_gaq"in window&&(_gaq.push(["_trackPageview",s]),_gaq.push(["_trackEvent","read","read",s])),clearInterval(n),n=null,B=!0;try{localStorage.setItem(H,0)}catch(e){console.log("Storage failed: "+e)}}}),2e3))};var U=wpOptions.siteurl,P=document.body.className.match(/[^postid-][0-9]+/),O=!!P&&P[0];function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}var R="js-lazy";var X="table-container",V=function(e){for(var t=!1,n=e.parentElement;n;){if(n.classList.contains(X)){t=!0;break}n=n.parentElement}return t};var G={laziness:0,throttle:500,scriptUrl:"https://simpletalk.disqus.com/embed.js"},W=function(e,t){var n,o;return function(){var a=this,r=arguments,i=+new Date;n&&i<n+e?(clearTimeout(o),o=setTimeout((function(){n=i,t.apply(a,r)}),e)):(n=i,t.apply(a,r))}},M=!1,F=!1,J=!1,Y=!1,K="unloaded",Z=!1,ee=function(e){if(!Z||!document.body.contains(Z)||"loaded"==Z.disqusLoaderStatus)return!0;if(!0!==e){var t=window.pageYOffset,n=(o=Z,a=o.getBoundingClientRect(),{top:a.top+document.body.scrollTop,left:a.left+document.body.scrollLeft}).top;if(n-t>window.innerHeight*F||t-n-Z.offsetHeight-window.innerHeight*F>0)return!0}var o,a,r,i,c,s=document.getElementById("disqus_thread");s&&s.removeAttribute("id"),Z.setAttribute("id","disqus_thread"),Z.disqusLoaderStatus="loaded","loaded"==K?DISQUS.reset({reload:!0,config:J}):(window.disqus_config=J,"unloaded"==K&&(K="loading",r=Y,i=function(){K="loaded"},(c=document.createElement("script")).src=r,c.async=!0,c.setAttribute("data-timestamp",+new Date),c.addEventListener("load",(function(){i()})),(document.head||document.body).appendChild(c)))};var te,ne,oe;(function(){if(void 0!==window._prum){var e=document.getElementsByTagName("script")[0],t=document.createElement("script");t.async="async",t.src="//rum-static.pingdom.net/prum.min.js",e.parentNode.insertBefore(t,e)}})(),void 0!==window.jQuery?window.jQuery(".js-dropdown").find("li").each((function(){var e=window.jQuery(this);if(!e.hasClass("dropdown--no-arrow")&&e.find("ul").length>0&&"true"!==e.attr("data-arrow-added")){var t=window.jQuery("<a/>").attr("href","#toggle").attr("tabindex","-1").addClass("arrow");e.addClass("dropdown ".concat(n)),e.attr("data-arrow-added","true"),t.appendTo(e)}})):window.console.warn("Honeycomb: jQuery not found, so dropdown functionality won't work as expected"),void 0!==window.jQuery?(window.jQuery("body").on("click",'.js-dropdown a[href="#toggle"]',(function(e){var o=window.jQuery(this).parent();e.preventDefault(),o.hasClass(t)?o.removeClass(t).addClass(n):o.addClass(t).removeClass(n)})),document.querySelector("body").addEventListener("click",(function(e){if(document.querySelector(".dropdown.".concat(t)))for(var a=document.querySelectorAll(".dropdown"),r=e.target,i=0;i<a.length;i++){var c=a[i],s=c.classList.contains(t);!o(c,r)&&s&&(c.classList.remove(t),c.classList.add(n))}}))):window.console.warn("Honeycomb: jQuery not found, so dropdown functionality won't work as expected"),function(){if(void 0!==window.jQuery?window.jQuery(".js-header-primary-collapse").each((function(e,t){var n=window.jQuery(t),o=n.find(".header--primary__menu--mobile");n.wrapInner('<div class="header--primary__container"></div>'),n.addClass("header--primary--has-inner-container"),o.appendTo(n)})):window.console.warn("Honeycomb: jQuery not found, so header functionality won't work as expected"),function(){if(void 0!==window.jQuery){var e=window.jQuery(".js-header-primary-collapse"),t="dropdown--open";e.each((function(){window.jQuery("body").on("click",".header--primary__container .dropdown .arrow",(function(){var e=window.jQuery(this),n=e.parents(".header--primary");e.parent("li").hasClass("open")?n.addClass(t):n.removeClass(t)}))}))}else window.console.warn("Honeycomb: jQuery not found, so header functionality won't work as expected")}(),void 0!==window.jQuery){var e=window.jQuery("body");e.on("click",".header--primary__menu-button",(function(t){t.preventDefault(),e.hasClass("mobile-nav--open")?e.removeClass("mobile-nav--open"):e.addClass("mobile-nav--open")})),e.on("click",".header--primary__menu--mobile .dropdown > a",(function(e){if("#toggle"!==this.getAttribute("href")){e.preventDefault();var t=window.jQuery(this).siblings('a[href="#toggle"]');t&&t.trigger("click")}}))}else window.console.warn("Honeycomb: jQuery not found, so header functionality won't work as expected")}(),void 0!==window.jQuery?window.jQuery("body").on("click",".notification--block .notification__close",(function(e){e.preventDefault(),window.jQuery(this).parent().parent().slideUp({complete:function(){window.jQuery(this).remove()}})})):window.console.warn("Honeycomb: jQuery not found, so notifications won\t work as expected"),function(){for(var e=document.querySelectorAll("img.js-svg"),t=function(t){var n=e[t],o=n.getAttribute("src").replace(/(.png)|(.gif)/,".svg"),a=new Image;a.src=o,a.onload=function(){n.setAttribute("src",o)}},n=0;n<e.length;n++)t(n)}(),void 0!==window.jQuery?(window.jQuery(".js-reveal").each((function(){var e=window.jQuery(this);e.attr("data-reveal-open")||e.slideUp(0)})),window.jQuery(".js-reveal-cta").each((function(){var e=window.jQuery(this),t=window.jQuery(this);e.attr("data-reveal-open")?t.attr("data-reveal-cta-close-html",t.html()):t.attr("data-reveal-cta-open-html",t.html())})).on("click",(function(e){e.preventDefault();var t=this,n=window.jQuery(this),o=n.attr("href"),a=window.jQuery(o),i=n.attr("data-reveal-group")||!1;if(a.is(":visible"))c(this,te);else if(i){for(var s=window.jQuery('.js-reveal-cta[data-reveal-group="'+i+'"]'),d=0,l=0;l<s.length;l++){var u=s[l];window.jQuery(window.jQuery(u).attr("href")).is(":visible")?c(u,(function(){r(t,te)})):d++}d===s.length&&r(t,te)}else r(this,te)}))):window.console.warn("Honeycomb: jQuery not found, so reveal functionality won't work as expected"),window.addEventListener("load",(function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};window.addEventListener("load",l.bind(d,e))}({url:"//cdn.rd.gt/assets/scripts/vendor/jquery.fancybox.pack.js"})})),_.setAccountId("UA-90206-1"),_.setCrossDomainAccountId("UA-90206-169"),_.setSites(["www.red-gate.com","www.sqlservercentral.com","documentation.red-gate.com","sqlmonitormetrics.red-gate.com"]),_.init({trackPageView:!1}),window.ST=window.ST||{},window.ST.analytics=L,window.addEventListener("load",(function(){L.init({analytics:_}),window.ST&&(window.ST.analytics={trackerId:L.getTrackerId()})})),function(){var e=!1;function t(){!1===e&&(e=!0,Munchkin.init("808-ITG-788"))}var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src="//munchkin.marketo.net/munchkin.js",n.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||t()},n.onload=t,document.getElementsByTagName("head")[0].appendChild(n)}(),window.addEventListener("load",(function(){var t,n;t=e,1===window.location.pathname.indexOf("simple-talk/account")&&((n=$(".cbxbookmark-category-list li:last-child")).parent().prepend(n),function(e){var t=e.getUrlParameterByName("cbxbmcatid"),n=$(".cbxbookmark-category-list li a");t?n.each((function(){var e=new RegExp("cbxbmcatid="+t+"$");this.href.match(e)&&$(this).parent().addClass("active")})):$(".cbxbookmark-category-list li:first-of-type").addClass("active")}(t),$(".account__bookmarks").css("visibility","inherit"))})),window.addEventListener("load",(function(){I()})),window.addEventListener("load",(function(){document.hasFocus()?D(N):window.onfocus=function(){D(N)}})),$('iframe[src*="youtube.com"]').wrap('<div class="video-wrapper" />'),$("body").hasClass("single")&&(oe={action:"st_yasr_get_visitor_votes",post_id:O},$.post("".concat(U,"/wp-admin/admin-ajax.php"),oe,(function(e){var t=JSON.parse(e)[0],n=t.sum_votes/t.number_of_votes;$(".rateit").rateit("value",n)})),$(".yasr_visitor_votes_stars_div").on("rated",(function(){var e=$(this);if(ne=e.rateit("value").toFixed(1),e.parent().addClass("yasr-hide-ratings"),ne>1){var t={action:"st_yasr_send_visitor_rating",rating:ne,post_id:O};$.post("".concat(U,"/wp-admin/admin-ajax.php"),t)}})),$(document).ajaxComplete((function(e,t,n){if(-1!==n.data.indexOf("action=yasr_send_visitor_rating")){var o={action:"st_yasr_get_visitor_votes",post_id:O};$.post("".concat(U,"/wp-admin/admin-ajax.php"),o,(function(e){var t=JSON.parse(e)[0];t.number_of_votes+=parseInt(t.number_of_votes)+1,t.sum_votes+=parseInt(t.sum_votes)+ne;var n=t.sum_votes/t.number_of_votes;$(".rateit").rateit("value",n),$(".yasr-visitor-votes").removeClass("yasr-hide-ratings")}))}}))),window.addEventListener("load",(function(){$(".site-nav .nav-bar ul").on("scroll",(function(){this.scrollLeft>0?$(this).addClass("scrolling"):$(this).removeClass("scrolling")})),function(){var e=document.querySelector(".header--primary");if(!e)return!1;var t=e.querySelectorAll("a");if(0===t.length)return!1;for(var n=0;n<t.length;n++)"Learning &amp; community"===t[n].innerHTML&&(t[n].className=t[n].className+" active")}(),function(){var e=document.querySelectorAll(".nav-bar, .hub-nav");if(0===e.length)return!1;var t=window.location.pathname.toLowerCase(),n=[t],o=[],a="";if(void 0===z(t))return!1;".htm"===t.substr(t.length-4,4)?n.push(t.substr(0,t.length-4)):n.push("".concat(t,".htm"));for(var r=0;r<e.length;r++){for(var i=e[r],c=i.querySelectorAll("a"),s=0;s<c.length;s++){var d=c[s],l=document.createElement("a");l.href=d.getAttribute("href");for(var u=0;u<n.length;u++)n[u].match(l.pathname)&&-1==o.indexOf(l.pathname)&&o.push(l.pathname)}if(o.length>0)for(var w=0;w<o.length;w++){var f=a.split("/").length,m=o[w].split("/").length;""===a.split("/")[a.split("/").length-1]&&f--,""===o[w].split("/")[o[w].split("/").length-1]&&m--,m>=f&&(a=o[w])}if(""!==a)for(var p=i.querySelectorAll('[href$="'.concat(a,'"]')),v=0;v<p.length;v++)"LI"===p[v].parentElement.nodeName&&(p[v].parentElement.className=p[v].parentElement.className+" active")}}(),$('a[href="https://www.red-gate.com/search"]').attr("href","https://www.red-gate.com/search?t=simpletalk")})),$('.nav-bar--dark a[href$="simple-talk/"]').parent().addClass("active"),function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};void 0===window.jQuery.fn.lazyload?(void 0===t.url&&(t.url="//cdn.rd.gt/assets/scripts/scripts/external/lazyload.min.js"),s(t.url,(function(){e(t)}))):$(".".concat(R)).lazyload()}(),function(){for(var e=document.querySelectorAll(".article__content table"),t=0;t<e.length;t++){var n=e[t];if(!V(n)&&!n.classList.contains("crayon-table")){var o=document.createElement("div");o.classList.add(X),n.parentNode.insertBefore(o,n),o.appendChild(n)}}}(),window.addEventListener("load",(function(){window.location.search.match("view=print")&&window.setTimeout(window.print,1500)})),function(){window.addEventListener("scroll",W(M,ee)),window.addEventListener("resize",W(M,ee));var e=document.querySelector('a[href="#load-disqus"]');e&&e.addEventListener("click",(function(e){e.preventDefault(),ee(!0)})),window.disqusLoader=function(e,t){F=t.laziness+1,M=t.throttle,J=t.disqusConfig,Y=!1===Y?t.scriptUrl:Y,(Z="string"==typeof e?document.querySelector(e):"number"==typeof e.length?e[0]:e)&&(Z.disqusLoaderStatus="unloaded"),ee()},window.disqusLoader(".js-disqus",G)}()})();
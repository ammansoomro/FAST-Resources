!function(){"use strict";!function e(){if("loading"===document.readyState)return document.addEventListener("DOMContentLoaded",e);function t(e,t){var a=e.querySelector('[name="webcomic_transcript_id"]'),n=e.querySelector('[name="webcomic_transcript"]'),r=e.querySelector('[name="webcomic_transcript_language[]"]'),c=document.querySelector(t.hash);if(a.value=t.id,n.value=t.content,r&&(r.selectedIndex=-1,t.languages))for(var o=0;o<r.options.length;o++)-1!==t.languages.indexOf(parseInt(r.options[o].value))&&(r.options[o].selected=!0);if(c)for(var i=c.querySelectorAll(".webcomic-transcribe-cancel-link"),s=0;s<i.length;s++)i[s].style.display="none",t.id&&(i[s].style.display=null);window.location.hash=t.hash,t.id&&n.focus()}function a(){for(var e=document.querySelectorAll(".webcomic-transcripts-toggle .webcomic-transcripts-toggler"),t=document.querySelectorAll(".webcomic-transcribe-cancel-link"),a=0;a<e.length;a++)e[a].dispatchEvent(new Event("change",{bubbles:!0}));for(var n=0;n<t.length;n++)t[n].style.display="none",window.location.href.match(/\/transcribe\/\d+\/#.+$/)&&window.location.hash===t[n].querySelector(".webcomic-transcribe-link").hash&&(t[n].style.display=null)}document.addEventListener("change",function(e){if("select"===e.target.tagName.toLowerCase()&&e.target.classList.contains("webcomic-transcripts-toggler")){for(var t=e.target;t.tagName&&!t.classList.contains("webcomic-transcripts-toggle");)t=t.parentNode;if(t.tagName)for(var a=t.querySelectorAll(".webcomic_transcript.type-webcomic_transcript"),n=e.target.options[e.target.selectedIndex].className.match(/webcomic_transcript_\S+-\S+/),r=0;r<a.length;r++)a[r].style.display="none",n&&a[r].classList.contains(n[0])&&(a[r].style.display=null)}}),document.addEventListener("click",function(e){for(var a=e.target;a&&a.tagName&&"a"!==a.tagName.toLowerCase();)a=a.parentNode;if(a.tagName&&a.classList.contains("webcomic-transcribe-link")){var n=a.href.match(/(?:\/transcribe\/(\d+)\/)?(#.+)$/),r=a.className.match(/webcomic-transcribe-parent-(\d+)/);if(n&&r){var c=document.querySelector(n[2]+" form");if(c&&c.querySelector('[name="webcomic_transcript"]')&&c.querySelector('[name="webcomic_transcript_id"]')&&(e.preventDefault(),t(c,{url:a.href,hash:n[2],id:0,content:"",languages:[]}),n[1])){var o=new FormData,i=new XMLHttpRequest;o.append("action","webcomic_transcribe"),o.append("post",parseInt(n[1])),o.append("parent",parseInt(r[1])),i.onreadystatechange=function(){if(4===i.readyState)if(i.responseText){var e=JSON.parse(i.responseText);e.url=a.href,e.hash=n[2],t(c,e)}else window.location.href=a.href},i.open("POST",webcomicCommonJS.ajaxurl),i.send(o)}}}}),a(),new MutationObserver(function(e){for(var t=0;t<e.length;t++)if(e[t].addedNodes.length)for(var n=0;n<e[t].addedNodes.length;n++){var r=e[t].addedNodes[n];r&&r.tagName&&r.classList.contains("webcomic-dynamic")&&a()}}).observe(document.querySelector("body"),{childList:!0,subtree:!0})}()}();
